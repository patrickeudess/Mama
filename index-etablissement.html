<!DOCTYPE html>
<html lang="fr">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes" />
    <title>MAMA+ Tableau de bord - √âtablissement de sant√©</title>
    <link rel="stylesheet" href="styles.css" />
    <link rel="stylesheet" href="styles-icons.css" />
    <link rel="stylesheet" href="styles-mobile-nav.css" />
  </head>
  <body>
    <header role="banner" class="tools-header">
      <div class="header-left">
        <a href="index.html" style="color: #fff; text-decoration: none; font-size: 1.5rem; margin-right: 1rem; display: inline-flex; align-items: center;" title="Retour √† l'accueil" id="home-icon-link"></a>
        <span class="header-icon" id="header-icon"></span>
        <h1>MAMA+ ‚Äì Tableau de bord √©tablissement</h1>
      </div>
      <div id="auth-section" role="navigation">
        <div id="user-info" aria-live="polite">
          <span id="user-name" aria-label="Nom de l'utilisateur"></span>
          <button id="logout-button" type="button" aria-label="Se d√©connecter" class="btn-secondary" style="margin-left: 1rem; padding: 0.5rem 1rem;">D√©connexion</button>
        </div>
      </div>
    </header>

    <main role="main">
      <!-- Alerte critique -->
      <section id="critical-alert-section" class="critical-alert hidden" style="margin: 1rem 0; padding: 1rem; background: linear-gradient(135deg, #fee2e2 0%, #fecaca 100%); border-left: 4px solid #dc2626; border-radius: 0.5rem; box-shadow: 0 2px 8px rgba(220, 38, 38, 0.2);">
        <div style="display: flex; align-items: center; gap: 1rem;">
          <span style="font-size: 1.5rem;">‚ö†Ô∏è</span>
          <div style="flex: 1;">
            <strong style="color: #991b1b; font-size: 1rem; display: block; margin-bottom: 0.25rem;" id="critical-alert-text"></strong>
            <button id="critical-alert-action" class="btn-primary" style="margin-top: 0.5rem; padding: 0.5rem 1rem; font-size: 0.875rem; background: #dc2626; border: none; color: white; border-radius: 0.375rem; cursor: pointer;">
              Voir les patientes concern√©es
            </button>
          </div>
          <button id="dismiss-alert" style="background: none; border: none; font-size: 1.5rem; cursor: pointer; color: #991b1b; padding: 0.25rem;">&times;</button>
        </div>
      </section>

      <!-- Vue synth√©tique pour d√©cision -->
      <section class="dashboard-stats-section" id="dashboard-section">
        <!-- KPIs Principaux -->
        <div class="card stats-card">
          <div class="card-header-with-icon">
            <span class="card-icon" id="card-icon-stats"></span>
            <h2>Vue d'ensemble - Indicateurs cl√©s</h2>
          </div>
          <div id="dashboard-stats-content" class="stats-grid">
            <div class="loading-state" style="text-align: center; padding: 2rem; color: #6b7280;">
              <p>Chargement des indicateurs...</p>
            </div>
          </div>
        </div>

        <!-- Alertes et Actions Prioritaires -->
        <div class="card" id="priority-actions-card" style="margin-top: 1.5rem;">
          <div class="card-header-with-icon">
            <span class="card-icon" id="card-icon-alerts"></span>
            <h2>Actions prioritaires</h2>
          </div>
          <div id="priority-actions-content" class="priority-actions-grid">
            <!-- Contenu g√©n√©r√© dynamiquement -->
          </div>
        </div>

      </section>

      <!-- Grille d'outils √©tablissement -->
      <section class="tools-grid-section" id="tools-section">
        <div class="tools-grid">
          <!-- Toutes les patientes -->
          <a href="mes-patientes.html" class="tool-card" id="tool-patientes">
            <div class="tool-icon-wrapper">
              <div class="tool-icon-circle" style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);">
                <span class="tool-icon">üë•</span>
              </div>
            </div>
            <div class="tool-content">
              <h3 class="tool-title">Toutes les patientes</h3>
              <p class="tool-subtitle">Vue globale de toutes les patientes</p>
            </div>
            <div class="tool-audio-icon">üîä</div>
          </a>

          <!-- Professionnels -->
          <a href="professionnels.html" class="tool-card" id="tool-professionnels">
            <div class="tool-icon-wrapper">
              <div class="tool-icon-circle" style="background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);">
                <span class="tool-icon">üë®‚Äç‚öïÔ∏è</span>
              </div>
            </div>
            <div class="tool-content">
              <h3 class="tool-title">Professionnels</h3>
              <p class="tool-subtitle">G√©rer les professionnels de sant√©</p>
            </div>
            <div class="tool-audio-icon">üîä</div>
          </a>

          <!-- Statistiques -->
          <a href="statistiques.html" class="tool-card" id="tool-stats">
            <div class="tool-icon-wrapper">
              <div class="tool-icon-circle" style="background: linear-gradient(135deg, #fa709a 0%, #fee140 100%);">
                <span class="tool-icon">üìä</span>
              </div>
            </div>
            <div class="tool-content">
              <h3 class="tool-title">Statistiques</h3>
              <p class="tool-subtitle">Rapports et analyses institutionnels</p>
            </div>
            <div class="tool-audio-icon">üîä</div>
          </a>

          <!-- Alertes -->
          <a href="alertes.html" class="tool-card" id="tool-alerts">
            <div class="tool-icon-wrapper">
              <div class="tool-icon-circle" style="background: linear-gradient(135deg, #ff9a9e 0%, #fecfef 100%);">
                <span class="tool-icon">‚ö†Ô∏è</span>
              </div>
            </div>
            <div class="tool-content">
              <h3 class="tool-title">Alertes</h3>
              <p class="tool-subtitle">Cas prioritaires √† suivre</p>
            </div>
            <div class="tool-audio-icon">üîä</div>
          </a>

          <!-- G√©ovisualisation -->
          <a href="geovisualisation.html" class="tool-card" id="tool-map">
            <div class="tool-icon-wrapper">
              <div class="tool-icon-circle" style="background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%);">
                <span class="tool-icon">üìç</span>
              </div>
            </div>
            <div class="tool-content">
              <h3 class="tool-title">G√©ovisualisation</h3>
              <p class="tool-subtitle">Carte des patientes</p>
            </div>
            <div class="tool-audio-icon">üîä</div>
          </a>

          <!-- Mon Profil -->
          <a href="profil-etablissement.html" class="tool-card" id="tool-profile">
            <div class="tool-icon-wrapper">
              <div class="tool-icon-circle" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
                <span class="tool-icon">üè•</span>
              </div>
            </div>
            <div class="tool-content">
              <h3 class="tool-title">Profil √©tablissement</h3>
              <p class="tool-subtitle">G√©rer les informations</p>
            </div>
            <div class="tool-audio-icon">üîä</div>
          </a>
        </div>
      </section>

    </main>

    <footer role="contentinfo">
      <small>Prototype MAMA+ ‚Äì Am√©lioration du suivi pr√©natal</small>
    </footer>

    <!-- Syst√®me d'authentification -->
    <script src="utils/auth.js"></script>
    <script>
      // Prot√©ger la page - v√©rifier la connexion
      if (!window.protectPage || !window.protectPage('etablissement')) {
        // Redirection en cours
      }
    </script>
    <!-- Syst√®me d'ic√¥nes -->
    <script src="utils/icons.js"></script>
    <script>
      // Initialiser les ic√¥nes au chargement
      document.addEventListener('DOMContentLoaded', function() {
        if (window.getIcon) {
          const homeIconLink = document.querySelector('#home-icon-link');
          if (homeIconLink) {
            homeIconLink.innerHTML = window.getIcon('home', 24, 'white');
          }
          
          const headerIcon = document.querySelector('#header-icon');
          if (headerIcon) {
            headerIcon.innerHTML = window.getIcon('users', 28, 'white') || window.getIcon('doctor', 28, 'white');
          }
          
          const cardIconEstablishment = document.querySelector('#card-icon-establishment');
          if (cardIconEstablishment) {
            cardIconEstablishment.innerHTML = window.getIcon('users', 24, '#3b82f6') || window.getIcon('doctor', 24, '#3b82f6');
          }
          
          const cardIconStats = document.querySelector('#card-icon-stats');
          if (cardIconStats) {
            cardIconStats.innerHTML = window.getIcon('stats', 24, '#3b82f6');
          }
          
          const cardIconAlerts = document.querySelector('#card-icon-alerts');
          if (cardIconAlerts) {
            cardIconAlerts.innerHTML = window.getIcon('alert', 24, '#dc2626') || '‚ö†Ô∏è';
          }
          
        }
      });
    </script>
    <!-- Navigation mobile -->
    <script src="utils/mobile-nav.js" defer></script>
    <!-- Utilitaires pour les micro-graphiques -->
    <script src="utils/sparklines.js"></script>
    <!-- Liste des centres de sant√© -->
    <script src="utils/health-centers-ci.js"></script>
    <!-- Syst√®me de filtres globaux -->
    <script src="utils/global-filters.js"></script>
    <!-- Am√©liorations du tableau de bord -->
    <script src="utils/dashboard-enhancements.js"></script>
    <!-- Script pour √©tablissement -->
    <script src="app-etablissement.js" defer></script>
    <style>
      /* Styles pour l'interface synth√©tique orient√©e d√©cision */
      .kpi-main {
        background: linear-gradient(135deg, #eff6ff 0%, #dbeafe 100%);
        border-left: 4px solid #3b82f6;
      }
      
      .stat-value-large {
        font-size: 2.5rem;
        font-weight: 700;
        line-height: 1.2;
        margin-bottom: 0.5rem;
      }
      
      .stat-subtitle {
        color: #6b7280;
        font-size: 0.875rem;
        margin-top: 0.25rem;
      }
      
      .stat-indicator {
        font-size: 0.75rem;
        font-weight: 600;
        margin-top: 0.5rem;
      }
      
      .stat-alert {
        padding: 0.25rem 0.5rem;
        border-radius: 0.25rem;
        font-size: 0.75rem;
        font-weight: 600;
        margin-top: 0.5rem;
      }
      
      .priority-actions-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        gap: 1rem;
        margin-top: 1rem;
      }
      
      .priority-action-card {
        transition: transform 0.2s, box-shadow 0.2s;
      }
      
      .priority-action-card:hover {
        transform: translateY(-2px);
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
      }
      
      .trends-container {
        margin-top: 1rem;
      }
      
      @media (max-width: 768px) {
        .stats-grid {
          grid-template-columns: 1fr;
        }
        
        .priority-actions-grid {
          grid-template-columns: 1fr;
        }
        
        .stat-value-large {
          font-size: 2rem;
        }
      }
    </style>
  </body>
</html>

